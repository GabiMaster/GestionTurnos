<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReservIt! SPA - Turnos</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-light">
    <div class="container" x-data="spaApp()" x-init="init()">
        <header>
            <h1>ReservIt! SPA</h1>
            <template x-if="!jwt">
                <form @submit.prevent="login" class="login-form">
                    <h2>Iniciar sesi�n</h2>
                    <input type="email" x-model="loginData.email" placeholder="Email" required>
                    <input type="password" x-model="loginData.password" placeholder="Contrase�a" required>
                    <button type="submit" :disabled="loading">Entrar</button>
                    <div class="error" x-text="mensaje" x-show="mensaje"></div>
                </form>
            </template>
            <template x-if="jwt">
                <div class="user-bar">
                    <span>Sesi�n iniciada</span>
                    <button @click="logout">Cerrar sesi�n</button>
                </div>
            </template>
        </header>
        <main x-show="jwt">
            <section>
                <h2>Agendar Turno</h2>
                <div>
                    <label>Servicio</label>
                    <select x-model="nuevoTurno.servicioId">
                        <option value="">Seleccione un servicio</option>
                        <template x-for="s in servicios" :key="s.id">
                            <option :value="s.id" x-text="s.nombre"></option>
                        </template>
                    </select>
                </div>
                <div>
                    <label>Fecha y hora</label>
                    <input type="datetime-local" x-model="nuevoTurno.fechaHora">
                </div>
                <button @click="agendarTurno" :disabled="loading || !nuevoTurno.servicioId || !nuevoTurno.fechaHora">
                    <span x-show="loading">?</span> Agendar
                </button>
                <div class="info" x-text="mensaje" x-show="mensaje"></div>
                <template x-if="qrUrl">
                    <div class="qr-result">
                        <h4>QR generado</h4>
                        <img :src="qrUrl" alt="QR generado" style="width:200px;height:200px;" />
                    </div>
                </template>
            </section>
        </main>
    </div>
    <script src="app.js"></script>
</body>
</html>
